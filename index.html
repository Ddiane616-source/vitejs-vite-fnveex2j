<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>口译知识准备 · 音频资料库</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root {
        --bg: #f6f7fb;
        --card: #ffffff;
        --accent: #ff4b4b;
        --accent-soft: #ffe5e5;
        --text-main: #111827;
        --text-muted: #6b7280;
        --border: #e5e7eb;
        --radius: 16px;
      }
      * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI',
          sans-serif;
        background: var(--bg);
        color: var(--text-main);
        padding: 18px 16px 90px;
      }
      .app {
        max-width: 720px;
        margin: 0 auto;
      }
      .title-main {
        font-size: 22px;
        font-weight: 700;
        text-align: center;
        margin-bottom: 4px;
      }
      .title-sub {
        font-size: 13px;
        text-align: center;
        color: var(--text-muted);
        margin-bottom: 16px;
      }
      .search-box {
        width: 100%;
        padding: 10px 14px;
        border-radius: 999px;
        border: 1px solid var(--border);
        font-size: 14px;
        outline: none;
        margin-bottom: 16px;
        background: #f9fafb;
      }
      .search-box:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 1px var(--accent-soft);
        background: #ffffff;
      }
      .list {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .card {
        background: var(--card);
        border-radius: var(--radius);
        padding: 12px 14px;
        box-shadow: 0 4px 14px rgba(15, 23, 42, 0.08);
        border: 1px solid rgba(148, 163, 184, 0.3);
        cursor: pointer;
        transition: 0.15s ease;
      }
      .card:hover {
        transform: translateY(-1px);
        box-shadow: 0 8px 20px rgba(15, 23, 42, 0.12);
      }
      .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
        margin-bottom: 6px;
      }
      .card-title {
        font-size: 15px;
        font-weight: 600;
        line-height: 1.3;
      }
      .pill {
        font-size: 12px;
        padding: 4px 10px;
        border-radius: 999px;
        background: var(--accent-soft);
        color: var(--accent);
        white-space: nowrap;
      }
      .card-desc {
        font-size: 13px;
        color: var(--text-muted);
        margin-bottom: 8px;
      }
      .card-footer {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 12px;
        color: var(--text-muted);
      }
      .play-chip {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 10px;
        border-radius: 999px;
        background: #fff5f5;
        color: var(--accent);
        font-weight: 500;
      }
      .play-chip span.icon {
        font-size: 14px;
      }

      /* 底部播放器 */
      .player-bar {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        background: #ffffff;
        border-top: 1px solid var(--border);
        box-shadow: 0 -4px 14px rgba(15, 23, 42, 0.14);
        padding: 8px 12px;
      }
      .player-inner {
        max-width: 720px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .player-btn {
        width: 42px;
        height: 42px;
        border-radius: 999px;
        border: none;
        background: var(--accent);
        color: #ffffff;
        font-size: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        flex-shrink: 0;
      }
      .player-text {
        flex: 1;
        min-width: 0;
      }
      .player-title {
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 2px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .player-sub {
        font-size: 11px;
        color: var(--text-muted);
      }
      .player-audio {
        width: 100%;
        margin-top: 4px;
      }
      @media (max-width: 480px) {
        body {
          padding: 14px 10px 90px;
        }
        .player-inner {
          flex-direction: row;
          align-items: flex-start;
        }
        .player-audio {
          display: none;
        } /* 小屏直接用浏览器原生悬浮控件即可 */
      }
    </style>
  </head>
  <body>
    <div class="app">
      <div class="title-main">口译知识准备 · 音频库</div>
      <div class="title-sub">Culture - China 等音频素材，支持后续持续扩展</div>

      <input
        id="searchInput"
        class="search-box"
        type="text"
        placeholder="搜索音频标题，例如：Culture / China / 口译…"
      />

      <div id="list" class="list"></div>
    </div>

    <!-- 底部播放器 -->
    <div class="player-bar">
      <div class="player-inner">
        <button id="playBtn" class="player-btn" disabled>▶</button>
        <div class="player-text">
          <div id="playerTitle" class="player-title">尚未选择音频</div>
          <div id="playerSub" class="player-sub">点击上方卡片开始播放</div>
          <audio id="audioEl" class="player-audio" controls></audio>
        </div>
      </div>
    </div>

    <script>
      // 现在只有一个音频，将来可以在这里继续加
      const audioData = [
        {
          id: 1,
          title: 'Culture - China',
          file: 'Culture - China.mp3', // 和实际文件名完全一致，且与 index.html 同目录
          description: '口译知识准备：文化主题 · 中国（示例音频）。',
          duration: '≈ 3 分钟',
        },
        // 未来新增示例：
        // { id: 2, title: "Economy - China", file: "Economy - China.mp3", description: "...", duration: "2:30" }
      ];

      const listEl = document.getElementById('list');
      const searchInput = document.getElementById('searchInput');
      const audioEl = document.getElementById('audioEl');
      const playBtn = document.getElementById('playBtn');
      const playerTitle = document.getElementById('playerTitle');
      const playerSub = document.getElementById('playerSub');

      let currentId = null;

      function renderList(keyword = '') {
        const kw = keyword.trim().toLowerCase();
        listEl.innerHTML = '';

        audioData
          .filter((item) => {
            if (!kw) return true;
            return (
              item.title.toLowerCase().includes(kw) ||
              (item.description || '').toLowerCase().includes(kw)
            );
          })
          .forEach((item) => {
            const card = document.createElement('div');
            card.className = 'card';
            card.onclick = () => playTrack(item.id);

            const header = document.createElement('div');
            header.className = 'card-header';

            const title = document.createElement('div');
            title.className = 'card-title';
            title.textContent = item.title;

            const pill = document.createElement('div');
            pill.className = 'pill';
            pill.textContent = '口译知识准备';

            header.appendChild(title);
            header.appendChild(pill);

            const desc = document.createElement('div');
            desc.className = 'card-desc';
            desc.textContent = item.description || '';

            const footer = document.createElement('div');
            footer.className = 'card-footer';

            const dur = document.createElement('div');
            dur.textContent = item.duration || '';

            const playChip = document.createElement('div');
            playChip.className = 'play-chip';
            playChip.innerHTML = `<span class="icon">▶</span><span>播放音频</span>`;

            footer.appendChild(dur);
            footer.appendChild(playChip);

            card.appendChild(header);
            card.appendChild(desc);
            card.appendChild(footer);

            listEl.appendChild(card);
          });

        if (!listEl.innerHTML) {
          listEl.innerHTML =
            '<div style="text-align:center;color:#9ca3af;font-size:13px;padding:20px 0;">没有找到匹配的音频</div>';
        }
      }

      function playTrack(id) {
        const track = audioData.find((t) => t.id === id);
        if (!track) return;
        const isSame = currentId === id;
        const isPlaying = !audioEl.paused && !audioEl.ended && audioEl.src;

        // 如果是同一条并且正在播放，则改为暂停
        if (isSame && isPlaying) {
          audioEl.pause();
          updatePlayBtn();
          return;
        }

        if (!isSame) {
          audioEl.src = track.file;
          currentId = id;
          playerTitle.textContent = track.title;
          playerSub.textContent = track.duration || '正在播放';
        }

        audioEl.play().catch((err) => {
          console.warn('自动播放可能被浏览器限制：', err);
        });
        playBtn.disabled = false;
        updatePlayBtn();
      }

      function updatePlayBtn() {
        const isPlaying = !audioEl.paused && !audioEl.ended && audioEl.src;
        playBtn.textContent = isPlaying ? '⏸' : '▶';
      }

      playBtn.addEventListener('click', () => {
        if (!audioEl.src) return;
        if (audioEl.paused || audioEl.ended) {
          audioEl.play();
        } else {
          audioEl.pause();
        }
        updatePlayBtn();
      });

      audioEl.addEventListener('play', updatePlayBtn);
      audioEl.addEventListener('pause', updatePlayBtn);
      audioEl.addEventListener('ended', updatePlayBtn);

      searchInput.addEventListener('input', (e) => {
        renderList(e.target.value);
      });

      renderList();
    </script>
  </body>
</html>
